<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/styles/style.css">
  <link rel="stylesheet" href="/styles/modal.css">
  <title>F√≥rum</title>
</head>

<body>

  <div id="posts">
    <h2>Posts</h2>
    <a href="#" id="openModal">Criar novo post</a>
    <ul>
      <li data-id="1">
        <h3 class="post-title">Primeiro Post</h3>
        <div class="post-actions">
          <button class="like-button">‚ô°</button>
          <span class="likes">0</span>
        </div>
      </li>
      <li data-id="2">
        <h3 class="post-title">Segundo Post</h3>

        <div class="post-actions">
          <button class="like-button">‚ô°</button>
          <span class="likes">0</span>
        </div>
      </li>
    </ul>
  </div>

  <!-- Modal para criar novo post -->
  <div id="createPostModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Criar Novo Post</h2>
      <form id="createPostForm">
        <label for="titulo">T√≠tulo:</label>
        <input type="text" id="titulo" name="titulo" required>
        <label for="conteudo">Conte√∫do:</label>
        <textarea id="conteudo" name="conteudo" required></textarea>
        <button type="submit">Criar</button>
      </form>
    </div>
  </div>

  <!-- Modal para exibir detalhes do post -->
  <div id="postModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 id="postTitle"></h2>
      <p>Autor: <span id="postAuthor"></span></p>
      <p>Descri√ß√£o: <span id="postDescription"></span></p>
      <p>Comentar:</p>
      <textarea id="comment" name="comment" rows="4" cols="50"></textarea>
      <br>
      <button>üõ´</button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const createPostModal = document.getElementById("createPostModal");
      const postModal = document.getElementById("postModal");
      const btn = document.getElementById("openModal");
      const span = document.getElementsByClassName("close");

      btn.onclick = function () {
        createPostModal.style.display = "block";
      }

      span.onclick = function () {
        createPostModal.style.display = "none";
        postModal.style.display = "none";
      }

      window.onclick = function (event) {
        if (event.target == createPostModal) {
          createPostModal.style.display = "none";
        }
        if (event.target == postModal) {
          postModal.style.display = "none";
        }
      }

      document.querySelectorAll('.post-title').forEach(title => {
        title.addEventListener('click', function () {
          const postId = this.closest('li').getAttribute('data-id');
          const postDetails = getPostDetails(postId);
          document.getElementById('postTitle').textContent = postDetails.titulo;
          document.getElementById('postAuthor').textContent = postDetails.autor;
          document.getElementById('postDescription').textContent = postDetails.descricao;
          postModal.style.display = "block";
        });
      });

      document.querySelectorAll('.like-button').forEach(button => {
        button.addEventListener('click', () => {
          const postElement = button.closest('li');
          const postId = postElement.getAttribute('data-id');
          const likesElement = postElement.querySelector('.likes');
          const currentLikes = parseInt(likesElement.textContent);
          const newLikes = button.textContent === '‚ô°' ? currentLikes + 1 : currentLikes - 1;

          fetch(`/posts/${postId}/like`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ likes: newLikes })
          }).then(() => {
            likesElement.textContent = newLikes;
            button.textContent = newLikes > 0 ? '‚ù§Ô∏è' : '‚ô°';
          });
        });
      });
    });

    function getPostDetails(postId) {
      // Aqui voc√™ pode implementar a l√≥gica para buscar os detalhes do post com o ID especificado
      // Por enquanto, retornaremos informa√ß√µes fict√≠cias para demonstra√ß√£o
      if (postId === '1') {
        return { titulo: 'Primeiro Post', autor: 'Autor do Primeiro Post', descricao: 'Descri√ß√£o do Primeiro Post' };
      } else if (postId === '2') {
        return { titulo: 'Segundo Post', autor: 'Autor do Segundo Post', descricao: 'Descri√ß√£o do Segundo Post' };
      }
      // Retornamos um objeto vazio se o ID do post n√£o for encontrado
      return {};
    }
  </script>
</body>

</html>
